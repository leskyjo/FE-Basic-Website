COURSES WEB APP FINAL (REVISED TO ALIGN WITH ONBOARDING OVERVIEW + TIERS & ACCESS)

This is a mobile-first Courses blueprint for the Felon Entrepreneur web app. It is revised only where necessary to align with:

Onboarding Overview 100% Final: public experience is one landing page only, and logged-out users attempting /courses are redirected to / or gated to login/signup. 

Onboarding Overview 100% Final

Tiers and Access Revised: tier model is starter | trial | plus | pro, Trial is 7-Day Pro-Lite Trial and converts to Plus by default if not canceled, otherwise reverts to Starter. 

TIERS AND ACCESS REVISED

All other non-conflicting content from the original Courses blueprint is preserved.

0. Purpose & Scope (unchanged intent, clarified to match master rules)

Main purpose of Courses:

Give users practical, real-world training (FE Originals + handpicked partner courses). 

COURSES WEB APP FINAL

Tie learning directly to jobs and income via built-in job support “tokens” (resume/application/interview prep) granted per course purchase. 

COURSES WEB APP FINAL

Respect that many users may never subscribe, but will pay for a course if it clearly moves them forward. 

COURSES WEB APP FINAL

Key decisions (revised only where required for alignment):

Account required to browse in-app Courses experiences (because the public site is landing-only). Logged-out users do not have a public catalog route anymore. 

Onboarding Overview 100% Final

Account required for purchase & access remains true (buy course, watch lessons, use tokens). 

COURSES WEB APP FINAL

No creator marketplace yet (only a Coming Soon teaser block). 

COURSES WEB APP FINAL

Security remains prioritized at every layer:

Purchases and user-specific data behind Supabase RLS (row-level security). 

COURSES WEB APP FINAL

Payment handled by Stripe (no card data stored in our DB). 

COURSES WEB APP FINAL

Course media served via signed URLs only to authorized users. 

COURSES WEB APP FINAL

1. Routes & Navigation (REVISED: remove public /courses browsing)
1.1 Route Map (Next.js App Router)

Per onboarding rules, the public site is only / plus /login and /signup. Attempts to access /courses while logged out must be redirected or gated. 

Onboarding Overview 100% Final

Therefore, Courses must live exclusively inside the authenticated app shell.

App routes (require auth + onboarding complete):

/fe/courses — In-app Courses Home (catalog listing, tier-aware pricing)

/fe/courses/[courseId] — In-app Course Detail (ownership + progress aware)

/fe/courses/[courseId]/learn — Course player (lessons, progress)

/fe/my-courses — “My Courses” list (all purchased/owned courses)

These routes already exist conceptually in the original blueprint and remain the canonical routes going forward. 

COURSES WEB APP FINAL

1.2 Route Guards (must be consistent with onboarding)

All Courses routes must require:

Valid Supabase session (logged in)

Onboarding complete (same OnboardingGate used by Dashboard/Plan/Jobs) 

COURSES WEB APP FINAL

If user is logged in but onboarding incomplete:

Redirect them to the correct onboarding step (do not allow entry into Courses).

If user is logged out:

Redirect to /login?redirect=/fe/courses (or / with a minimal gate per onboarding rules). 

Onboarding Overview 100% Final

2. Navigation & Entry Points (Mobile vs Desktop/Tablet)
2.1 Mobile (primary)

Global bottom nav remains:

Home | Plan | FE (center glowing) | Jobs | Profile 

COURSES WEB APP FINAL

Tapping FE opens the FE Hub overlay.

FE Hub includes: “Courses & Training” → /fe/courses (requires login + onboarding complete). 

COURSES WEB APP FINAL

If the user is not logged in and somehow hits the FE Hub entry:

Send to /login?redirect=/fe/courses. 

COURSES WEB APP FINAL

2.2 Desktop / Laptop / Tablet

Because the public site is landing-only, there is no public top-nav item that links to /courses. 

Onboarding Overview 100% Final

Inside the authenticated app shell:

Header includes FE button that opens FE Hub.

FE Hub includes: “Courses & Training” → /fe/courses.

3. Core UI Screens (Front-End Visuals + Functionality)
3.1 In-App Courses Home (/fe/courses)

Component: <AppCoursesHome /> wrapped in app shell. 

COURSES WEB APP FINAL

Content sections (unchanged intent):

Featured FE Originals

Partner courses

Full catalog listing

“Creator Marketplace – Coming Soon” teaser block 

COURSES WEB APP FINAL

Mobile UI requirements:

Single-column stacked cards

Large tappable course cards

Sticky filter/sort drawer (optional)

Bottom nav visible (FE highlighted)

Desktop/Tablet UI requirements:

Grid layout (2–4 columns depending on width)

Filters pinned left or top

Same data and CTA logic as mobile

Course card CTA logic:

If user owns course: show “Owned” badge + “Continue” or “Start Course” button. 

COURSES WEB APP FINAL

If not owned: show “Buy Course” button with tier-adjusted price (see Tier & Pricing section). 

COURSES WEB APP FINAL

3.2 In-App Course Detail (/fe/courses/[courseId])

Component: <AppCourseDetailPage /> 

COURSES WEB APP FINAL

Shows:

Promo video / preview (marketing content)

What they’ll learn

Curriculum preview

What is included (certificate + job support tokens)

Effective price (resolved from tier + pricing rules)

CTA states:

If not purchased:

Primary button: “Buy This Course – $XX (Your tier price)”

Supporting copy:

Starter: “You don’t need a subscription to buy this course. Your purchase includes job support for this skill.” 

COURSES WEB APP FINAL

Plus/Pro: “Your discount has been applied.” 

COURSES WEB APP FINAL

If purchased:

“Continue Course” → /fe/courses/[courseId]/learn

“View My Certificate” if completed 

COURSES WEB APP FINAL

Mobile vs Desktop/Tablet:

Mobile: vertically stacked sections, full-width CTA button, avoid dense pricing blocks.

Desktop/Tablet: 2-column layout is allowed (video left, details right), but CTA must remain prominent.

3.3 Course Player (/fe/courses/[courseId]/learn)

Component: <CoursePlayerPage /> 

COURSES WEB APP FINAL

Mobile layout (must be thumb-friendly):

Sticky header with course title + “Back to Courses”

Video/content panel at top

Lesson title + transcript/notes

Prev/Next buttons (large touch targets)

Curriculum list as toggle/drawer

“Job Tools For This Skill” section with buttons:

“Build Resume for This Skill”

“Use Application Assistant for This Skill”

“Start Interview Prep for This Skill” 

COURSES WEB APP FINAL

Desktop/Tablet layout:

Video player left + curriculum list right (or vice versa)

Notes/transcript below

Job Tools section can be a right-side card or below main content

Progress behavior:

On lesson completion, call backend to mark progress.

If all lessons complete: mark purchase complete + certificate_issued true, show toast “Course complete. Certificate ready.” 

COURSES WEB APP FINAL

3.4 My Courses (/fe/my-courses)

Component: <MyCoursesPage /> 

COURSES WEB APP FINAL

List of owned courses:

Thumbnail, title, instructor

Progress bar

Continue / Restart

View Certificate if completed 

COURSES WEB APP FINAL

4. Tier, Pricing, and Tokens (REVISED to match tier model + trial rules)
4.1 Canonical Tier Model (must match Tier & Access)

Use one tier column:

profiles.tier values: starter, trial, plus, pro 

TIERS AND ACCESS REVISED

Courses must not rely on:

plan_tier

trial_tier = plus or pro

Those are explicitly replaced by the canonical tier model. (Original Courses doc references profiles.plan_tier and trial_tier for pricing resolution; that is now invalid.) 

COURSES WEB APP FINAL

4.2 Trial Definition (must match Tier & Access)

Trial is:

7-Day Pro-Lite Trial

A distinct tier: tier = trial

End behavior:

If user does not cancel → converts to Plus

If user cancels before end → reverts to Starter 

TIERS AND ACCESS REVISED

4.3 Course Pricing Rules (kept consistent, clarified for Trial)

Base rule remains:

Starter pays base price.

Plus gets a configurable discount (e.g., 10–15%).

Pro gets a configurable larger discount (e.g., 20–25%). 

COURSES WEB APP FINAL

Trial pricing (revised to avoid “trial_tier = plus/pro” concept):

Trial is not “plus trial” or “pro trial.” It is its own state. 

TIERS AND ACCESS REVISED

Therefore, Trial pricing must be explicitly defined as one of:

Option A (recommended for consistency): Trial pays Starter price (no subscription discount during trial).

Option B (allowed but must be explicitly coded): Trial gets a dedicated trial_discount_percent.

To avoid inventing new commercial rules not present elsewhere, implement Option A by default: Trial pays Starter/base price unless you later decide to add a formal trial_discount_percent in Settings.

4.4 Tokens (preserved concept, clarified to align with tool gating)

Each course purchase grants:

1 resume token

1 application_assist token

1 interview_prep token 

COURSES WEB APP FINAL

Tokens are:

Independent of subscription tier.

Available as long as unconsumed. 

COURSES WEB APP FINAL

Token consumption priority (required for clean alignment across modules):

When user clicks a Job Tool from the Course Player:

Use an eligible, unconsumed course token first (if present for that tool). 

COURSES WEB APP FINAL

If no token is available, fall back to tier entitlements/limits (Plus/Pro monthly counters, Starter AI credits where applicable). 

TIERS AND ACCESS REVISED

If neither token nor tier allowance is available, show locked UI + upgrade / purchase CTA.

Important alignment note:

Tier & Access states that Resume Builder is “locked” for Starter and Trial (meaning 0 included uses). 

TIERS AND ACCESS REVISED

Courses tokens are treated as purchase-derived single-use entitlements. They do not contradict “0 included uses,” because they are not included tier allowances—they are tied to a paid course purchase.

5. Back-End Endpoints & Logic (Next.js Route Handlers)
5.1 Catalog & Detail

GET /api/courses
Returns published courses for in-app browsing.

GET /api/courses/[courseId]
Returns course detail.

Both endpoints:

Require auth + onboarding complete (because Courses is inside the app shell).

Must not return signed media playback URLs unless the user is authorized (see Media Security below).

5.2 Purchase Flow (Stripe)

Primary:

POST /api/courses/[courseId]/purchase 

COURSES WEB APP FINAL

Required server logic:

Authenticate user

Resolve effective tier from profiles.tier (starter/trial/plus/pro)

Calculate final price_cents using base price + discount rules (as above)

Create Stripe PaymentIntent/Checkout and validate amount + currency server-side

Create purchase record

Grant tokens by inserting 3 rows into course_tokens 

COURSES WEB APP FINAL

Webhook (strongly recommended):

Stripe webhook verifies payment event and idempotently finalizes purchase + tokens, using a unique transaction id to prevent duplicates. 

COURSES WEB APP FINAL

5.3 Progress Updates

POST /api/courses/[courseId]/progress 

COURSES WEB APP FINAL

Server checks:

Authenticated

User owns the course (has course_purchases row)

Upsert lesson progress

If course complete:

Set course_purchases.completed_at

Set certificate_issued = true 

COURSES WEB APP FINAL

5.4 My Courses

GET /api/my-courses returns purchases joined with courses and aggregated progress. 

COURSES WEB APP FINAL

6. Database Schema (Supabase Postgres) + RLS
6.1 Core Tables (as originally defined, with only necessary alignment changes)

Courses tables remain as in original doc, including:

courses

course_lessons

course_purchases

course_tokens

course_progress

RLS guidance from original doc remains relevant (with one key adjustment below). 

COURSES WEB APP FINAL

6.2 RLS Adjustments Required (because there is no public catalog route now)

Original doc allowed “Public SELECT allowed only for published courses.” 

COURSES WEB APP FINAL

Since we removed public browsing routes to align with the onboarding master, adjust to:

Authenticated SELECT only for catalog and detail (user must be logged in).

Keep published filtering at the API layer and/or DB layer, but do not permit anonymous catalog browsing via direct DB queries.

Purchases & progress RLS remains:

course_purchases: user can SELECT/UPDATE their rows; no deletes. 

COURSES WEB APP FINAL

course_tokens: user can SELECT their tokens; token consumption should be done via server/RPC to prevent tampering.

course_progress: user can write only for owned courses (best enforced via server route/RPC).

6.3 Media Security (must remain strict)

Store lesson media in secure storage.

Never expose raw storage keys publicly.

Issue signed URLs only after server verifies:

Authenticated

User owns course OR lesson is a free preview (if you support previews later)

Signed URLs should be short-lived.

7. Security Requirements (Non-Negotiable)
7.1 Prevent purchase spoofing

Client cannot “mark course owned.”

Ownership exists only if server/webhook has created course_purchases.

Server must validate Stripe amount/currency (do not trust client payload). 

COURSES WEB APP FINAL

7.2 Prevent token fraud

Tokens must not be directly insertable/consumable by the client.

Consumption must be server-controlled and logged (usage_events recommended, consistent with Tier & Access). 

TIERS AND ACCESS REVISED

7.3 Tier consistency

Courses must read profiles.tier only.

Client must never write tier fields, subscription status, or trial timestamps (money fields). 

TIERS AND ACCESS REVISED

8. Email Flows (preserved, with routing alignment)

Emails remain as originally described: 

COURSES WEB APP FINAL

8.1 Course Purchase Receipt

Trigger:

After purchase + tokens are successfully created (preferably from webhook finalization). 

COURSES WEB APP FINAL

Must include:

Course name, price, date

“Start your course now” link → /fe/courses/[courseId]/learn (requires login)

8.2 Welcome to Course (optional)

Same email or separate

Quick “first steps”

Reminder about job tool tokens

8.3 Course Completion / Certificate

Trigger:

When certificate_issued becomes true.

Email includes:

Link to certificate view/download inside app

Suggest adding skill to resume + using job tools/tokens 

COURSES WEB APP FINAL

9. Settings / Admin Controls (Operational requirements)

Define settings (server-stored; not client-trust):

plus_course_discount_percent

pro_course_discount_percent

(Optional) trial_course_discount_percent (only if you intentionally choose Trial discount)

Admin management needs:

Publish/unpublish courses

Upload lesson media

Update course pricing

Support tooling: view purchases, grant refunds, re-issue access if needed

10. Builder Implementation Checklist (Courses)

Builder must implement:

Remove public /courses and /courses/[courseId] browsing experience (landing-only public rules). 

Onboarding Overview 100% Final

Implement /fe/courses, /fe/courses/[courseId], /fe/courses/[courseId]/learn, /fe/my-courses behind auth + onboarding gate. 

COURSES WEB APP FINAL

Replace any usage of profiles.plan_tier and trial_tier with canonical profiles.tier (starter|trial|plus|pro). 

COURSES WEB APP FINAL

Enforce Trial as 7-Day Pro-Lite Trial with webhook-driven state transitions defined in Tier & Access. 

TIERS AND ACCESS REVISED

Stripe-backed purchase flow with server validation + webhook finalization. 

COURSES WEB APP FINAL

Token grant + server-controlled token consumption (tokens first, then tier allowances). 

COURSES WEB APP FINAL

Signed URL media delivery based on ownership verification. 

COURSES WEB APP FINAL

Purchase receipt + completion emails. 

COURSES WEB APP FINAL